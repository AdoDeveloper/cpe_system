<nav class="main-header navbar navbar-expand navbar-white navbar-light">
  <!-- Left navbar links -->
  <ul class="navbar-nav align-items-center">
    <li class="nav-item">
      <a class="nav-link" data-widget="pushmenu" href="#" role="button">
        <i class="fas fa-bars"></i>
      </a>
    </li>

    <!-- Breadcrumb din치mico junto a Inicio, oculto en pantallas peque침as -->
    <li class="nav-item d-none d-md-block">
      <nav aria-label="breadcrumb" class="breadcrumb-nav">
        <span>{{createBreadcrumb currentRoute}}</span>
      </nav>
    </li>
  </ul>

  <!-- Right navbar links -->
  <ul class="navbar-nav ml-auto">
    <!-- Notificaciones -->
    <li class="nav-item dropdown">
      <a class="nav-link" data-toggle="dropdown" href="#">
        <i class="far fa-bell"></i>
        <span id="notificationCount" class="badge badge-warning navbar-badge">{{notificationCount}}</span>
      </a>
      <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right" id="notificationDropdown">
        <span class="dropdown-header font-weight-bold text-center">Notificaciones</span>
        <div class="dropdown-divider"></div>
        <div id="notificationList" class="notification-list">
          {{#each notificaciones}}
          <a href="/tickets/timeline/{{this.ticketId}}" class="dropdown-item d-flex align-items-center notification-item">
            <div class="icon mr-3">
              <i class="fas fa-ticket-alt text-primary"></i>
            </div>
            <div class="text">
              <span class="notification-message font-weight-bold">{{this.mensaje}}</span>
              <div class="text-muted small">{{formatDate this.createdAt}}</div>
            </div>
          </a>
          {{/each}}
        </div>
        <div class="dropdown-divider"></div>
        <a href="/notificaciones" class="dropdown-item dropdown-footer text-center text-primary font-weight-bold">
          Ver todas las notificaciones
        </a>
      </div>
    </li>

    <!-- Perfil de usuario -->
    <li class="nav-item dropdown">
      <a class="nav-link" data-toggle="dropdown" href="#">
        <i class="far fa-user"></i>
        <span>{{ userName }}</span>
      </a>
      <div class="dropdown-menu dropdown-menu-right">
        <a href="/perfil" class="dropdown-item">
          <i class="fas fa-user-cog"></i> Perfil
        </a>
        <div class="dropdown-divider"></div>
        <form id="logout-form" action="/logout" method="GET" style="display: none;"></form>
        
        <a href="#" class="dropdown-item" onclick="document.getElementById('logout-form').submit();">
          <i class="fas fa-sign-out-alt"></i> Cerrar sesi칩n
        </a>
      </div>
    </li>
  </ul>
</nav>

<style>
  /* Contenedor del dropdown para evitar que el contenido sobresalga */
  #notificationDropdown {
    max-width: 300px;
    max-height: 400px;
    overflow-y: auto;
  }
  
  /* Estilo para cada notificaci칩n */
  .notification-item {
    display: flex;
    padding: 10px;
    border-radius: 4px;
    transition: background-color 0.2s ease;
    text-decoration: none !important;
    color: inherit;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .notification-item:hover {
    background-color: #f4f6f9; /* Color de hover */
    text-decoration: none;
  }
  .notification-item .icon i {
    font-size: 1.5rem;
  }
  .notification-item .text {
    flex: 1;
    font-size: 0.9rem;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .notification-item .notification-message {
    color: #495057;
    display: block;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .notification-item .text-muted {
    font-size: 0.8rem;
  }
</style>
